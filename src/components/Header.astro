---
import Menu from "../icons/Menu.astro";
import { toggleMenu } from "../navigation.js";
import Logo from "../icons/Logo.svg"
import { getLangFromUrl, useTranslations } from '../i18n/utils'

const lang = "es";
const t = useTranslations(lang);
---

<header
  class="fixed z-10 top-0 left-0 right-0 backdrop-blur border-white/10 border-b-2"
>
  <nav class="flex justify-between items-center py-3 w-[92%] mx-auto">
    <div class="flex items-center">
      <img src='/logo.png' width="50" height="50"/>
      <a href="" class="font-bold text-xl" set:html={t('nav.title')}></a>
    </div>
    <div
      class="nav-links duration-500 md:static absolute md:bg-transparent backdrop-blur backdrop-blur-10 md:shadow-none shadow-xl bg-lavanda md:min-h-fit min-h-[50vh] left-[-100%] top-14 md:w-auto w-full flex items-center px-5"
    >
      <ul
        class="flex md:flex-row flex-col md:items-center md:gap-[2vw] gap-6 font-medium "
      >
        <li>
          <a class="hover:opacity-50 transition px-3 py-1" href="#top">{t('nav.home')}</a>
        </li>
        <li>
          <a class="hover:opacity-50 transition px-3 py-1" href="#tech">{t('nav.tech')}</a>
        </li>
        <li>
          <a class="hover:opacity-50 transition px-3 py-1" href="#education"
            >{t('nav.education')}</a
          >
        </li>
        <li>
          <a class="hover:opacity-50 transition px-3 py-1" href="#experience"
            >{t('nav.experience')}</a
          >
        </li>
        <li>
          <a class="hover:opacity-50 transition px-3 py-1" href="#projects"
            >{t('nav.projects')}</a
          >
        </li>
      </ul>
    </div>

    <div class="flex items-center gap-2">

      <!-- 
      <div class="flex items-center gap-2">

        <span id="english" class="" >en</span>

        <div id="container" class="rounded-full bg-white h-auto w-14 p-0.5 flex">
          <div id="toggle" class="rounded-full bg-lavanda h-6 w-6 transition"></div>
        </div>

        <span id="spanish" class="opacity-50">es</span>

      </div>
      -->
      
      <span id="menuIcon" class="size-6 cursor-pointer md:hidden">☰</span>
    </div>
  </nav>
</header> 



<script>
  document.addEventListener("DOMContentLoaded", () => {
    // Menu
    const menuIcon = document.getElementById("menuIcon");
    const navLinks = document.querySelector(".nav-links");

    // toggle
    const toggle = document.getElementById("toggle");
    const container = document.getElementById("container");
    const english = document.getElementById("english");
    const spanish = document.getElementById("spanish");


    if (menuIcon) {
      menuIcon.addEventListener("click", () => {
        onToggleMenu();
      });
    }

    if (container) {
      container.addEventListener("click", () => {
        toggleButton();
        switchLanguage();
      });
    }

    const toggleButton = () => {
      container?.classList.toggle("flex-row-reverse");
      english?.classList.toggle("opacity-50");
      spanish?.classList.toggle("opacity-50");
    }

    const onToggleMenu = () => {
      navLinks?.classList.toggle("left-0");
      navLinks?.classList.toggle("left-[-100%]");
      if (menuIcon) {
        menuIcon.innerHTML = menuIcon.innerHTML === "☰" ? "✕" : "☰";
      }
    }

    const switchLanguage = () => {
      const currentLang = window.location.pathname.startsWith('/en') ? 'en' : 'es';
      const newLang = currentLang === 'en' ? 'es' : 'en';

      const newPath = window.location.pathname.replace(/^\/(en|es)/, `/${newLang}`);
      const newUrl = `${window.location.origin}${newPath}${window.location.search}${window.location.hash}`;
  
      window.location.href = newUrl;
    };

  });
</script>
